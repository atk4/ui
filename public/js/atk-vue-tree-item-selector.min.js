(self.webpackChunkatk=self.webpackChunkatk||[]).push([[507],{42973:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});i(67242),i(90170),i(42359),i(9228),i(42381),i(98590),i(58189),i(74916),i(46345),i(14098),i(29747),i(77572),i(35817),i(67124),i(14947),i(45712),i(5127),i(73988),i(79192),i(74238),i(96180);var n=i(21145),o=i.n(n);const r={template:'\n    <div class="item" :style="itemMargin">\n        <i :class="toggleIcon" @click="onToggleShow" v-show="!isRoot"></i>\n        <i :class="getIcon" @click="onToggleSelect" v-show="!isRoot"></i>\n        <div class="content">\n            <div @click="onToggleSelect" :style="itemCursor">{{title}}</div>\n            <div v-if="isParent" class="list" v-show="open || isRoot">\n                <atk-tree-item-selector\n                    v-for="item in item.nodes" :key="item.id"\n                    :item="item"\n                    :values="values"\n                ></atk-tree-item-selector>\n            </div>\n        </div>\n    </div>',props:{item:Object,values:Array},inject:["getRootData"],name:"atk-tree-item-selector",data:function(){return{open:!1,isRoot:"atk-root"===this.item.id,isInitialized:!1,id:this.item.id,nodes:this.item.nodes,icons:{single:{on:"circle",off:"circle outline",indeterminate:"dot circle outline"},multiple:{on:"check square outline",off:"square outline",indeterminate:"minus square outline"}}}},created:function(){this.getInitData()},mounted:function(){},computed:{itemMargin:function(){return{marginLeft:this.item.nodes&&this.item.nodes.length>0?this.open?"-13px":"-10px":null}},itemCursor:function(){return{cursor:this.isParent&&"single"===this.getRootData().options.mode?"default":"pointer"}},title:function(){return this.item.name},isParent:function(){return this.nodes&&this.nodes.length>0},toggleIcon:function(){return this.isParent?(this.open?"caret down":"caret right")+" icon":null},state:function(){let t="off";return this.isParent?t=this.hasAllFill(this.nodes)?"on":this.hasSomeFill(this.nodes)?"indeterminate":"off":this.isSelected(this.id)&&(t="on"),t},getIcon:function(){return this.icons[this.getRootData().options.mode][this.state]+" icon"}},methods:{isSelected:function(t){return this.values.filter((e=>e===t)).length>0},getInitData:function(){this.getRootData().item.isInitialized||(this.getRootData().values=this.getValues(),this.getRootData().item.isInitialized=!0)},getValues:function(){const t=JSON.parse(this.getInputElement().value);let e=[];return Array.isArray(t)?e=t:e.push(t),e},hasAllFill:function(t){let e=!0;for(let i=0;i<t.length;i++)if(t[i].nodes&&t[i].nodes.length>0){if(!this.hasAllFill(t[i].nodes)){e=!1;break}}else if(-1===this.values.findIndex((e=>e===t[i].id))){e=!1;break}return e},hasSomeFill:function(t){let e=!1;for(let i=0;i<t.length;i++){if(t[i].nodes&&t[i].nodes.length>0&&this.hasSomeFill(t[i].nodes)){e=!0;break}if(-1!==this.values.findIndex((e=>e===t[i].id))){e=!0;break}}return e},onToggleShow:function(){this.isParent&&(this.open=!this.open)},onToggleSelect:function(){const{options:t}=this.getRootData();switch(t.mode){case"single":this.handleSingleSelect();break;case"multiple":this.handleMultipleSelect()}},mergeArrays:function(){let t=[];for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach((e=>{t=[...t,...e]})),[...new Set([...t])]},collectAllChildren:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach((t=>{t.nodes&&t.nodes.length>0?e.concat(this.collectAllChildren(t.nodes,e)):e.push(t.id)})),e},remove:function(t,e){return t.filter((t=>t!==e))},handleSingleSelect:function(){"off"!==this.state||this.isParent||(this.getRootData().values=[this.item.id],this.setInput(this.item.id),this.getRootData().options.url&&this.postValue()),this.isParent&&(this.open=!this.open)},handleMultipleSelect:function(){let t;if(this.isParent){const e=this.collectAllChildren(this.nodes);if("off"===this.state||"indeterminate"===this.state)t=this.mergeArrays(this.values,e);else{let i=this.values;e.forEach((t=>{i=this.remove(i,t)})),t=i}}else"on"===this.state?t=this.remove(this.values,this.item.id):"off"===this.state&&(t=this.values,t.push(this.item.id));this.getRootData().values=[...t],this.setInput(JSON.stringify(t)),this.getRootData().options.url&&this.postValue()},setInput:function(t){this.getInputElement().value=t},getInputElement:function(){return document.getElementsByName(this.getRootData().field)[0]},postValue:function(){o()(this.$el).parents("."+this.getRootData().options.loader).api({on:"now",url:this.getRootData().options.url,method:"POST",data:{data:JSON.stringify(this.getRootData().values)}})}}}},38945:(t,e,i)=>{"use strict";var n=i(79611),o=i(97676),r=i(83875);t.exports=function(){for(var t=r(this),e=o(t.add),i=0,s=arguments.length;i<s;i++)n(e,t,arguments[i]);return t}},35612:(t,e,i)=>{"use strict";var n=i(79611),o=i(97676),r=i(83875);t.exports=function(){for(var t,e=r(this),i=o(e.delete),s=!0,a=0,l=arguments.length;a<l;a++)t=n(i,e,arguments[a]),s=s&&t;return!!s}},51353:(t,e,i)=>{var n=i(79611);t.exports=function(t){return n(Set.prototype.values,t)}},98590:(t,e,i)=>{"use strict";i(19882)({target:"Set",proto:!0,real:!0,forced:!0},{addAll:i(38945)})},58189:(t,e,i)=>{"use strict";i(19882)({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:i(35612)})},74916:(t,e,i)=>{"use strict";var n=i(19882),o=i(22773),r=i(79611),s=i(97676),a=i(83875),l=i(7270),u=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(t){var e=a(this),i=new(l(e,o("Set")))(e),n=s(i.delete);return u(t,(function(t){r(n,i,t)})),i}})},46345:(t,e,i)=>{"use strict";var n=i(19882),o=i(83875),r=i(98166),s=i(51353),a=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{every:function(t){var e=o(this),i=s(e),n=r(t,arguments.length>1?arguments[1]:void 0);return!a(i,(function(t,i){if(!n(t,t,e))return i()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},14098:(t,e,i)=>{"use strict";var n=i(19882),o=i(22773),r=i(79611),s=i(97676),a=i(83875),l=i(98166),u=i(7270),c=i(51353),h=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(t){var e=a(this),i=c(e),n=l(t,arguments.length>1?arguments[1]:void 0),d=new(u(e,o("Set"))),f=s(d.add);return h(i,(function(t){n(t,t,e)&&r(f,d,t)}),{IS_ITERATOR:!0}),d}})},29747:(t,e,i)=>{"use strict";var n=i(19882),o=i(83875),r=i(98166),s=i(51353),a=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{find:function(t){var e=o(this),i=s(e),n=r(t,arguments.length>1?arguments[1]:void 0);return a(i,(function(t,i){if(n(t,t,e))return i(t)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},77572:(t,e,i)=>{"use strict";var n=i(19882),o=i(22773),r=i(79611),s=i(97676),a=i(83875),l=i(7270),u=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(t){var e=a(this),i=new(l(e,o("Set"))),n=s(e.has),c=s(i.add);return u(t,(function(t){r(n,e,t)&&r(c,i,t)})),i}})},35817:(t,e,i)=>{"use strict";var n=i(19882),o=i(79611),r=i(97676),s=i(83875),a=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(t){var e=s(this),i=r(e.has);return!a(t,(function(t,n){if(!0===o(i,e,t))return n()}),{INTERRUPTED:!0}).stopped}})},67124:(t,e,i)=>{"use strict";var n=i(19882),o=i(22773),r=i(79611),s=i(97676),a=i(75277),l=i(83875),u=i(11805),c=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(t){var e=u(this),i=l(t),n=i.has;return a(n)||(i=new(o("Set"))(t),n=s(i.has)),!c(e,(function(t,e){if(!1===r(n,i,t))return e()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},14947:(t,e,i)=>{"use strict";var n=i(19882),o=i(79611),r=i(97676),s=i(83875),a=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(t){var e=s(this),i=r(e.has);return!a(t,(function(t,n){if(!1===o(i,e,t))return n()}),{INTERRUPTED:!0}).stopped}})},45712:(t,e,i)=>{"use strict";var n=i(19882),o=i(88697),r=i(83875),s=i(28967),a=i(51353),l=i(5166),u=o([].join),c=[].push;n({target:"Set",proto:!0,real:!0,forced:!0},{join:function(t){var e=r(this),i=a(e),n=void 0===t?",":s(t),o=[];return l(i,c,{that:o,IS_ITERATOR:!0}),u(o,n)}})},5127:(t,e,i)=>{"use strict";var n=i(19882),o=i(22773),r=i(98166),s=i(79611),a=i(97676),l=i(83875),u=i(7270),c=i(51353),h=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{map:function(t){var e=l(this),i=c(e),n=r(t,arguments.length>1?arguments[1]:void 0),d=new(u(e,o("Set"))),f=a(d.add);return h(i,(function(t){s(f,d,n(t,t,e))}),{IS_ITERATOR:!0}),d}})},73988:(t,e,i)=>{"use strict";var n=i(19882),o=i(97676),r=i(83875),s=i(51353),a=i(5166),l=TypeError;n({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(t){var e=r(this),i=s(e),n=arguments.length<2,u=n?void 0:arguments[1];if(o(t),a(i,(function(i){n?(n=!1,u=i):u=t(u,i,i,e)}),{IS_ITERATOR:!0}),n)throw l("Reduce of empty set with no initial value");return u}})},79192:(t,e,i)=>{"use strict";var n=i(19882),o=i(83875),r=i(98166),s=i(51353),a=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{some:function(t){var e=o(this),i=s(e),n=r(t,arguments.length>1?arguments[1]:void 0);return a(i,(function(t,i){if(n(t,t,e))return i()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},74238:(t,e,i)=>{"use strict";var n=i(19882),o=i(22773),r=i(79611),s=i(97676),a=i(83875),l=i(7270),u=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(t){var e=a(this),i=new(l(e,o("Set")))(e),n=s(i.delete),c=s(i.add);return u(t,(function(t){r(n,i,t)||r(c,i,t)})),i}})},96180:(t,e,i)=>{"use strict";var n=i(19882),o=i(22773),r=i(97676),s=i(83875),a=i(7270),l=i(5166);n({target:"Set",proto:!0,real:!0,forced:!0},{union:function(t){var e=s(this),i=new(a(e,o("Set")))(e);return l(t,r(i.add),{that:i}),i}})}}]);
//# sourceMappingURL=atk-vue-tree-item-selector.min.js.map