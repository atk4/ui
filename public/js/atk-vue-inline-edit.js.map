{"version":3,"file":"js/atk-vue-inline-edit.js","mappings":"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","sources":["webpack://atk/./src/vue-components/inline-edit.component.js"],"sourcesContent":["import $ from 'external/jquery';\n\n/**\n * Allow user to edit a db record inline and send\n * changes to server.\n *\n * Properties need for this component are:\n * context: string, a jQuery selector where the 'loading' class will be apply by Fomantic-UI - default to the requesting element.\n * url:     string, the URL to call.\n * value:   array, array of value to send to server.\n */\nexport default {\n    name: 'AtkInlineEdit',\n    template: `\n        <div :class=\"[options.inputCss, hasError ? 'error' : '' ]\">\n            <input\n                :class=\"options.inlineCss\"\n                :name=\"options.fieldName\"\n                :type=\"options.fieldType\"\n                v-model=\"value\"\n                @keyup=\"onKeyup\"\n                @focus=\"onFocus\"\n                @blur=\"onBlur\"\n            />\n            <i class=\"icon\" />\n        </div>`,\n    props: {\n        url: String,\n        initValue: String,\n        saveOnBlur: Boolean,\n        options: Object,\n    },\n    data: function () {\n        return {\n            value: this.initValue,\n            temp: this.initValue,\n            hasError: false,\n        };\n    },\n    computed: {\n        isDirty: function () {\n            return this.temp !== this.value;\n        },\n    },\n    methods: {\n        onFocus: function () {\n            if (this.hasError) {\n                this.clearError();\n            } else {\n                this.temp = this.value;\n            }\n        },\n        onKeyup: function (e) {\n            const key = e.keyCode;\n            this.clearError();\n            if (key === 13) {\n                this.onEnter();\n            } else if (key === 27) {\n                this.onEscape();\n            }\n        },\n        onBlur: function () {\n            if (this.isDirty && this.saveOnBlur) {\n                this.update();\n            } else {\n                this.value = this.temp; // TODO will not save the value on 2nd edit and submit via enter\n            }\n        },\n        onEscape: function () {\n            this.value = this.temp;\n            this.$el.querySelector('input').blur();\n        },\n        onEnter: function () {\n            if (this.isDirty) {\n                this.update();\n            }\n        },\n        clearError: function () {\n            this.hasError = false;\n        },\n        flashError: function (count = 4) {\n            if (count === 0) {\n                this.hasError = false;\n\n                return;\n            }\n            this.hasError = !this.hasError;\n            setTimeout(() => {\n                this.flashError(count - 1);\n            }, 300);\n        },\n        update: function () {\n            const that = this;\n            $(this.$el).api({\n                on: 'now',\n                url: this.url,\n                data: { value: this.value },\n                method: 'POST',\n                onComplete: function (r, e) {\n                    if (r.hasValidationError) {\n                        that.hasError = true;\n                    } else {\n                        that.temp = that.value;\n                    }\n                },\n            });\n        },\n    },\n};\n"],"names":["$","name","template","props","url","String","initValue","saveOnBlur","Boolean","options","Object","data","value","temp","hasError","computed","isDirty","methods","onFocus","clearError","onKeyup","e","key","keyCode","onEnter","onEscape","onBlur","update","$el","querySelector","blur","flashError","count","arguments","length","undefined","setTimeout","that","api","on","method","onComplete","r","hasValidationError"],"sourceRoot":""}