{"version":3,"file":"js/atk-vue-inline-edit.js","mappings":";;;;;;;;;;;;;;;AAAgC;;AAEhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAe;EACXC,IAAI,EAAE,eAAe;EACrBC,QAAQ,EAAG;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;EACXC,KAAK,EAAE;IACHC,GAAG,EAAEC,MAAM;IACXC,SAAS,EAAED,MAAM;IACjBE,UAAU,EAAEC,OAAO;IACnBC,OAAO,EAAEC;EACb,CAAC;EACDC,IAAI,EAAE,SAAAA,CAAA,EAAY;IACd,OAAO;MACHC,KAAK,EAAE,IAAI,CAACN,SAAS;MACrBO,cAAc,EAAE,IAAI,CAACP,SAAS;MAC9BQ,QAAQ,EAAE;IACd,CAAC;EACL,CAAC;EACDC,QAAQ,EAAE;IACNC,OAAO,EAAE,SAAAA,CAAA,EAAY;MACjB,OAAO,IAAI,CAACH,cAAc,KAAK,IAAI,CAACD,KAAK;IAC7C;EACJ,CAAC;EACDK,OAAO,EAAE;IACLC,OAAO,EAAE,SAAAA,CAAA,EAAY;MACjB,IAAI,IAAI,CAACJ,QAAQ,EAAE;QACf,IAAI,CAACK,UAAU,CAAC,CAAC;MACrB,CAAC,MAAM;QACH,IAAI,CAACN,cAAc,GAAG,IAAI,CAACD,KAAK;MACpC;IACJ,CAAC;IACDQ,OAAO,EAAE,SAAAA,CAAUC,CAAC,EAAE;MAClB,MAAMC,GAAG,GAAGD,CAAC,CAACE,OAAO;MACrB,IAAID,GAAG,KAAK,EAAE,EAAE;QACZ,IAAI,CAACE,OAAO,CAAC,CAAC;MAClB,CAAC,MAAM,IAAIF,GAAG,KAAK,EAAE,EAAE;QACnB,IAAI,CAACG,QAAQ,CAAC,CAAC;MACnB;IACJ,CAAC;IACDC,MAAM,EAAE,SAAAA,CAAA,EAAY;MAChB,IAAI,IAAI,CAACV,OAAO,EAAE;QACd,IAAI,IAAI,CAACT,UAAU,EAAE;UACjB,IAAI,CAACoB,MAAM,CAAC,CAAC;QACjB,CAAC,MAAM;UACH,IAAI,CAACf,KAAK,GAAG,IAAI,CAACC,cAAc;QACpC;MACJ;IACJ,CAAC;IACDY,QAAQ,EAAE,SAAAA,CAAA,EAAY;MAClB,IAAI,CAACb,KAAK,GAAG,IAAI,CAACC,cAAc;MAChC,IAAI,CAACe,GAAG,CAACC,aAAa,CAAC,OAAO,CAAC,CAACC,IAAI,CAAC,CAAC;IAC1C,CAAC;IACDN,OAAO,EAAE,SAAAA,CAAA,EAAY;MACjB,IAAI,IAAI,CAACR,OAAO,EAAE;QACd,IAAI,CAACW,MAAM,CAAC,CAAC;MACjB;IACJ,CAAC;IACDR,UAAU,EAAE,SAAAA,CAAA,EAAY;MACpB,IAAI,CAACL,QAAQ,GAAG,KAAK;IACzB,CAAC;IACDa,MAAM,EAAE,SAAAA,CAAA,EAAY;MAChB,MAAMI,IAAI,GAAG,IAAI;MACjB/B,sDAAC,CAAC,IAAI,CAAC4B,GAAG,CAAC,CAACI,GAAG,CAAC;QACZC,EAAE,EAAE,KAAK;QACT7B,GAAG,EAAE,IAAI,CAACA,GAAG;QACbO,IAAI,EAAE;UAAEC,KAAK,EAAE,IAAI,CAACA;QAAM,CAAC;QAC3BsB,MAAM,EAAE,MAAM;QACdC,UAAU,EAAE,SAAAA,CAAUC,CAAC,EAAEf,CAAC,EAAE;UACxB,IAAIe,CAAC,CAACC,kBAAkB,EAAE;YACtBN,IAAI,CAACjB,QAAQ,GAAG,IAAI;UACxB,CAAC,MAAM;YACHiB,IAAI,CAAClB,cAAc,GAAGkB,IAAI,CAACnB,KAAK;UACpC;QACJ;MACJ,CAAC,CAAC;IACN;EACJ;AACJ,CAAC","sources":["webpack://atk/./src/vue-components/inline-edit.component.js"],"sourcesContent":["import $ from 'external/jquery';\r\n\r\n/**\r\n * Allow user to edit a db record inline and send\r\n * changes to server.\r\n *\r\n * Properties need for this component are:\r\n * context: string, a jQuery selector where the 'loading' class will be apply by Fomantic-UI - default to the requesting element.\r\n * url:     string, the URL to call.\r\n * value:   array, array of value to send to server.\r\n */\r\nexport default {\r\n    name: 'AtkInlineEdit',\r\n    template: `\r\n        <div :class=\"[options.inputCss, hasError ? 'error' : '' ]\">\r\n            <input\r\n                :class=\"options.inlineCss\"\r\n                :name=\"options.fieldName\"\r\n                v-model=\"value\"\r\n                @keyup=\"onKeyup\"\r\n                @focus=\"onFocus\"\r\n                @blur=\"onBlur\"\r\n            />\r\n            <i class=\"icon\" />\r\n        </div>`,\r\n    props: {\r\n        url: String,\r\n        initValue: String,\r\n        saveOnBlur: Boolean,\r\n        options: Object,\r\n    },\r\n    data: function () {\r\n        return {\r\n            value: this.initValue,\r\n            lastValueValid: this.initValue,\r\n            hasError: false,\r\n        };\r\n    },\r\n    computed: {\r\n        isDirty: function () {\r\n            return this.lastValueValid !== this.value;\r\n        },\r\n    },\r\n    methods: {\r\n        onFocus: function () {\r\n            if (this.hasError) {\r\n                this.clearError();\r\n            } else {\r\n                this.lastValueValid = this.value;\r\n            }\r\n        },\r\n        onKeyup: function (e) {\r\n            const key = e.keyCode;\r\n            if (key === 13) {\r\n                this.onEnter();\r\n            } else if (key === 27) {\r\n                this.onEscape();\r\n            }\r\n        },\r\n        onBlur: function () {\r\n            if (this.isDirty) {\r\n                if (this.saveOnBlur) {\r\n                    this.update();\r\n                } else {\r\n                    this.value = this.lastValueValid;\r\n                }\r\n            }\r\n        },\r\n        onEscape: function () {\r\n            this.value = this.lastValueValid;\r\n            this.$el.querySelector('input').blur();\r\n        },\r\n        onEnter: function () {\r\n            if (this.isDirty) {\r\n                this.update();\r\n            }\r\n        },\r\n        clearError: function () {\r\n            this.hasError = false;\r\n        },\r\n        update: function () {\r\n            const that = this;\r\n            $(this.$el).api({\r\n                on: 'now',\r\n                url: this.url,\r\n                data: { value: this.value },\r\n                method: 'POST',\r\n                onComplete: function (r, e) {\r\n                    if (r.hasValidationError) {\r\n                        that.hasError = true;\r\n                    } else {\r\n                        that.lastValueValid = that.value;\r\n                    }\r\n                },\r\n            });\r\n        },\r\n    },\r\n};\r\n"],"names":["$","name","template","props","url","String","initValue","saveOnBlur","Boolean","options","Object","data","value","lastValueValid","hasError","computed","isDirty","methods","onFocus","clearError","onKeyup","e","key","keyCode","onEnter","onEscape","onBlur","update","$el","querySelector","blur","that","api","on","method","onComplete","r","hasValidationError"],"sourceRoot":""}