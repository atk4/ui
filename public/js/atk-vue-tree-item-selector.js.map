{"version":3,"file":"js/atk-vue-tree-item-selector.js","mappings":"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","sources":["webpack://atk/./src/vue-components/tree-item-selector/tree-item-selector.component.js"],"sourcesContent":["import $ from 'external/jquery';\n\nexport default {\n    name: 'AtkTreeItemSelector',\n    template: `\n        <div class=\"item\" :style=\"itemMargin\">\n            <i :class=\"toggleIcon\" @click=\"onToggleShow\" v-show=\"!isRoot\" />\n            <i :class=\"getIcon\" @click=\"onToggleSelect\" v-show=\"!isRoot\" />\n            <div class=\"content\">\n                <div @click=\"onToggleSelect\" :style=\"itemCursor\">{{title}}</div>\n                <div v-if=\"isParent\" class=\"list\" v-show=\"open || isRoot\">\n                    <AtkTreeItemSelector\n                        v-for=\"item in item.nodes\" :key=\"item.id\"\n                        :item=\"item\"\n                        :values=\"values\"\n                    ></AtkTreeItemSelector>\n                </div>\n            </div>\n        </div>`,\n    props: { item: Object, values: Array },\n    inject: ['getRootData'],\n    data: function () {\n        return {\n            open: false,\n            isRoot: this.item.id === 'atk-root',\n            isInitialized: false,\n            id: this.item.id,\n            nodes: this.item.nodes,\n            icons: {\n                single: {\n                    on: 'circle',\n                    off: 'circle outline',\n                    indeterminate: 'dot circle outline',\n                },\n                multiple: {\n                    on: 'check square outline',\n                    off: 'square outline',\n                    indeterminate: 'minus square outline',\n                },\n            },\n        };\n    },\n    created: function () {\n        this.getInitData();\n    },\n    mounted: function () {},\n    computed: {\n        itemMargin: function () {\n            return {\n                marginLeft: (this.item.nodes && this.item.nodes.length > 0)\n                    ? (this.open ? '-13px' : '-10px')\n                    : null,\n            };\n        },\n        itemCursor: function () {\n            return {\n                cursor: this.isParent && this.getRootData().options.mode === 'single' ? 'default' : 'pointer',\n            };\n        },\n        title: function () {\n            return this.item.name;\n        },\n        isParent: function () {\n            return (this.nodes && this.nodes.length > 0);\n        },\n        toggleIcon: function () {\n            return this.isParent\n                ? (this.open ? 'caret down' : 'caret right') + ' icon'\n                : null;\n        },\n        state: function () {\n            let state = 'off';\n            if (this.isParent) {\n                state = this.hasAllFill(this.nodes)\n                    ? 'on'\n                    : (this.hasSomeFill(this.nodes) ? 'indeterminate' : 'off');\n            } else if (this.isSelected(this.id)) {\n                state = 'on';\n            }\n\n            return state;\n        },\n        getIcon: function () {\n            return this.icons[this.getRootData().options.mode][this.state] + ' icon';\n        },\n    },\n    methods: {\n        isSelected: function (id) {\n            return this.values.includes(id);\n        },\n        /**\n         * Get input initial data.\n         */\n        getInitData: function () {\n            // check if input containing data is set and initialized.\n            if (!this.getRootData().item.isInitialized) {\n                this.getRootData().values = this.getValues();\n                this.getRootData().item.isInitialized = true;\n            }\n        },\n        getValues: function () {\n            const initValues = JSON.parse(this.getInputElement().value);\n            let values = [];\n            if (Array.isArray(initValues)) {\n                values = initValues;\n            } else {\n                values.push(initValues);\n            }\n\n            return values;\n        },\n        /**\n         * Check if all children nodes are on.\n         *\n         * @returns {boolean}\n         */\n        hasAllFill: function (nodes) {\n            let state = true;\n            for (const node of nodes) {\n                // check children first;\n                if (node.nodes && node.nodes.length > 0) {\n                    if (!this.hasAllFill(node.nodes)) {\n                        state = false;\n\n                        break;\n                    }\n                } else if (!this.values.includes(node.id)) {\n                    state = false;\n\n                    break;\n                }\n            }\n\n            return state;\n        },\n        /**\n         * Check if some children nodes are on.\n         *\n         * @returns {boolean}\n         */\n        hasSomeFill: function (nodes) {\n            let state = false;\n            for (const node of nodes) {\n                // check children first;\n                if (node.nodes && node.nodes.length > 0) {\n                    if (this.hasSomeFill(node.nodes)) {\n                        state = true;\n\n                        break;\n                    }\n                }\n                if (this.values.includes(node.id)) {\n                    state = true;\n\n                    break;\n                }\n            }\n\n            return state;\n        },\n        /**\n         * Fire when arrow are click in order to show or hide children.\n         */\n        onToggleShow: function () {\n            if (this.isParent) {\n                this.open = !this.open;\n            }\n        },\n        /**\n         * Fire when checkbox is click.\n         */\n        onToggleSelect: function () {\n            const { options } = this.getRootData();\n            switch (options.mode) {\n                case 'single':\n                    this.handleSingleSelect();\n\n                    break;\n                case 'multiple':\n                    this.handleMultipleSelect();\n\n                    break;\n            }\n        },\n        /**\n         * Merge array and remove duplicate.\n         *\n         * @returns {*[]}\n         */\n        mergeArrays: function (...arrays) {\n            let jointArray = [];\n\n            for (const array of arrays) {\n                jointArray = [...jointArray, ...array];\n            }\n\n            return [...new Set(jointArray)];\n        },\n        /**\n         * Get all id from all chidren node.\n         *\n         * @returns {Array.<string>}\n         */\n        collectAllChildren: function (nodes, ids = []) {\n            for (const node of nodes) {\n                if (node.nodes && node.nodes.length > 0) {\n                    ids = [...ids, ...this.collectAllChildren(node.nodes, ids)];\n                } else {\n                    ids.push(node.id);\n                }\n            }\n\n            return ids;\n        },\n        remove: function (values, value) {\n            return values.filter((val) => val !== value);\n        },\n        /**\n         * Handle a selection when in single mode.\n         */\n        handleSingleSelect: function () {\n            if (this.state === 'off' && !this.isParent) {\n                this.getRootData().values = [this.item.id];\n                this.setInput(this.item.id);\n                if (this.getRootData().options.url) {\n                    this.postValue();\n                }\n            }\n            if (this.isParent) {\n                this.open = !this.open;\n            }\n        },\n        /**\n         * Handle a selection when in multiple mode.\n         */\n        handleMultipleSelect: function () {\n            let values;\n            if (this.isParent) {\n                // collect all children value\n                const childValues = this.collectAllChildren(this.nodes);\n                if (this.state === 'off' || this.state === 'indeterminate') {\n                    values = this.mergeArrays(this.values, childValues);\n                } else {\n                    let temp = this.values;\n                    for (const value of childValues) {\n                        temp = this.remove(temp, value);\n                    }\n                    values = temp;\n                }\n            } else if (this.state === 'on') {\n                values = this.remove(this.values, this.item.id);\n            } else if (this.state === 'off') {\n                values = this.values;\n                values.push(this.item.id);\n            }\n\n            this.getRootData().values = [...values];\n            this.setInput(JSON.stringify(values));\n\n            if (this.getRootData().options.url) {\n                this.postValue();\n            }\n        },\n        /**\n         * Set input field with current mapped model value.\n         */\n        setInput: function (value) {\n            // console.log('set input');\n            this.getInputElement().value = value;\n        },\n        /**\n         * Get input element set for this Item Selector.\n         *\n         * @returns {HTMLElement}\n         */\n        getInputElement: function () {\n            return document.getElementsByName(this.getRootData().field)[0];\n        },\n        /**\n         * Send data using callback url.\n         */\n        postValue: function () {\n            $(this.$el).parents('.' + this.getRootData().options.loader).api({\n                on: 'now',\n                url: this.getRootData().options.url,\n                method: 'POST',\n                data: { data: JSON.stringify(this.getRootData().values) },\n            });\n        },\n    },\n};\n"],"names":["$","name","template","props","item","Object","values","Array","inject","data","open","isRoot","id","isInitialized","nodes","icons","single","on","off","indeterminate","multiple","created","getInitData","mounted","computed","itemMargin","marginLeft","length","itemCursor","cursor","isParent","getRootData","options","mode","title","toggleIcon","state","hasAllFill","hasSomeFill","isSelected","getIcon","methods","includes","getValues","initValues","JSON","parse","getInputElement","value","isArray","push","node","onToggleShow","onToggleSelect","handleSingleSelect","handleMultipleSelect","mergeArrays","jointArray","arrays","array","Set","collectAllChildren","ids","remove","filter","val","setInput","url","postValue","childValues","temp","stringify","document","getElementsByName","field","$el","parents","loader","api","method"],"sourceRoot":""}