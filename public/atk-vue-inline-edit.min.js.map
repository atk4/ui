{"version":3,"file":"atk-vue-inline-edit.min.js","mappings":"8IAeA,MAYA,GACIA,KAAM,kBACNC,SAdc,8WAedC,MAAO,CACHC,IAAKC,OACLC,UAAWD,OACXE,WAAY,CAAEC,KAAMC,QAASC,SAAS,GACtCC,QAAS,CACLH,KAAMI,OACNF,QAAS,KAAM,CACXG,SAAU,GAAIC,UAAW,GAAIC,UAAW,KAAMC,UAAW,WAIrEC,KAAM,WACF,MAAO,CACHC,MAAOC,KAAKb,UACZc,KAAMD,KAAKb,UACXe,UAAU,IAGlBC,SAAU,CACNC,QAAS,WACL,OAAOJ,KAAKC,OAASD,KAAKD,QAGlCM,QAAS,CACLC,QAAS,WACDN,KAAKE,SACLF,KAAKO,aAELP,KAAKC,KAAOD,KAAKD,OAGzBS,QAAS,SAAUC,GACf,MAAMC,EAAMD,EAAEE,QACdX,KAAKO,aACO,KAARG,EACAV,KAAKY,QAAQH,GACE,KAARC,GACPV,KAAKa,YAGbC,OAAQ,WACAd,KAAKI,SAAWJ,KAAKZ,aAAeY,KAAKE,SACzCF,KAAKe,SAELf,KAAKD,MAAQC,KAAKC,MAG1BY,SAAU,WACNb,KAAKD,MAAQC,KAAKC,KAClBD,KAAKgB,IAAIC,cAAc,SAASC,QAEpCN,QAAS,SAAUH,GACXT,KAAKI,SACLJ,KAAKe,UAGbR,WAAY,WACRP,KAAKE,UAAW,GAEpBiB,WAAY,SAAUC,EAAQ,GACZ,IAAVA,GAKJpB,KAAKE,UAAYF,KAAKE,SACtBmB,YAAW,KACPrB,KAAKmB,WAAWC,EAAQ,KACzB,MAPCpB,KAAKE,UAAW,GASxBa,OAAQ,WACJ,MAAMO,EAAOtB,KACbuB,GAAAA,CAAEvB,KAAKgB,KAAKQ,IAAI,CACZC,GAAI,MACJxC,IAAKe,KAAKf,IACVa,KAAM,CAAEC,MAAOC,KAAKD,OACpB2B,OAAQ,OACRC,WAAY,SAAUC,EAAGnB,GACjBmB,EAAEC,mBACFP,EAAKpB,UAAW,EAEhBoB,EAAKrB,KAAOqB,EAAKvB","sources":["webpack://atk/./src/components/inline-edit.component.js"],"sourcesContent":["import $ from 'jquery';\n\n/**\n * Vue component\n * Allow user to edit a db record inline and send\n * changes to server.\n *\n * Properties need for this component are:\n *\n * context: string, a jQuery selector where the 'loading' class will be apply by Fomantic-UI:\n *          - default to the requesting element.\n * url:     string, the url to call.\n * value:  array, array of value to send to server.\n */\n\nconst template = `\n      <div :class=\"[options.inputCss, hasError ? 'error' : '' ]\">\n            <input\n            :class=\"options.inlineCss\"\n            :name=\"options.fieldName\"\n            :type=\"options.fieldType\"\n            v-model=\"value\"\n            @keyup=\"onKeyup\"\n            @focus=\"onFocus\"\n            @blur=\"onBlur\" /><i class=\"icon\"></i>\n      </div>`;\n\nexport default {\n    name: 'atk-inline-edit',\n    template: template,\n    props: {\n        url: String,\n        initValue: String,\n        saveOnBlur: { type: Boolean, default: true },\n        options: {\n            type: Object,\n            default: () => ({\n                inputCss: '', inlineCss: '', fieldName: null, fieldType: 'text',\n            }),\n        },\n    },\n    data: function () {\n        return {\n            value: this.initValue,\n            temp: this.initValue,\n            hasError: false,\n        };\n    },\n    computed: {\n        isDirty: function () {\n            return this.temp !== this.value;\n        },\n    },\n    methods: {\n        onFocus: function () {\n            if (this.hasError) {\n                this.clearError();\n            } else {\n                this.temp = this.value;\n            }\n        },\n        onKeyup: function (e) {\n            const key = e.keyCode;\n            this.clearError();\n            if (key === 13) {\n                this.onEnter(e);\n            } else if (key === 27) {\n                this.onEscape();\n            }\n        },\n        onBlur: function () {\n            if (this.isDirty && this.saveOnBlur && !this.hasError) {\n                this.update();\n            } else {\n                this.value = this.temp;\n            }\n        },\n        onEscape: function () {\n            this.value = this.temp;\n            this.$el.querySelector('input').blur();\n        },\n        onEnter: function (e) {\n            if (this.isDirty) {\n                this.update();\n            }\n        },\n        clearError: function () {\n            this.hasError = false;\n        },\n        flashError: function (count = 4) {\n            if (count === 0) {\n                this.hasError = false;\n\n                return;\n            }\n            this.hasError = !this.hasError;\n            setTimeout(() => {\n                this.flashError(count - 1);\n            }, 300);\n        },\n        update: function () {\n            const that = this;\n            $(this.$el).api({\n                on: 'now',\n                url: this.url,\n                data: { value: this.value },\n                method: 'POST',\n                onComplete: function (r, e) {\n                    if (r.hasValidationError) {\n                        that.hasError = true;\n                    } else {\n                        that.temp = that.value;\n                    }\n                },\n            });\n        },\n    },\n};\n"],"names":["name","template","props","url","String","initValue","saveOnBlur","type","Boolean","default","options","Object","inputCss","inlineCss","fieldName","fieldType","data","value","this","temp","hasError","computed","isDirty","methods","onFocus","clearError","onKeyup","e","key","keyCode","onEnter","onEscape","onBlur","update","$el","querySelector","blur","flashError","count","setTimeout","that","$","api","on","method","onComplete","r","hasValidationError"],"sourceRoot":""}